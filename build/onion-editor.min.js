/*! onion-editor 2013-07-02 */
!function(a){"use strict";a.EditorModules=[];var b=b||function(b){function c(b){for(var c=0;c<a.EditorModules.length;c++)f.push(new a.EditorModules[c](d,b));$(b.element).append('<div class="editor-wrapper"><div class="editor" contenteditable="true" spellcheck="true"><p></p></div><div class="focus-cursor icon-caret-right"></div></div>'),d.emit("init"),$(b.element).bind("keydown",function(a){if(13===a.keyCode);else if(8===a.keyCode){var b=window.getSelection();"P"===b.focusNode.tagName&&1==$(".editor>*").length&&(console.log("nope, not deleting anything"),a.preventDefault())}d.emit("keydown")}).bind("keyup",function(){d.emit("keyup")}).bind("paste",function(b){var c=document.createDocumentFragment(),e=document.createElement("DIV");c.appendChild(e),a.frag=c;var f=b.originalEvent.clipboardData.getData("text/plain");if(c.querySelector("div").innerHTML=b.originalEvent.clipboardData.getData("text/html"),console.log(c),window.getSelection){var g=window.getSelection();if(g.getRangeAt&&g.rangeCount){var h=g.getRangeAt(0);h.deleteContents(),document.execCommand("InsertHTML",!1,f)}}b.preventDefault(),d.emit("paste")})}var d=this,e={element:null},f=[],g={enableEvents:function(a){a.__listeners__=a.__listeners__||{},a.on=function(b,c){var d=a.__listeners__[b]||(a.__listeners__[b]=[]);d.push(c)},a.off=function(b,c){for(var d=a.__listeners__[b]||[],e=[],f=0,g=d.length;g>f;f++)d[f]!==c&&e.push(d[f]);a.__listeners__[b]=e},a.emit=function(b){for(var c=Array.prototype.slice.call(arguments,1),d=a.__listeners__[b]||[],e=0,f=d.length;f>e;e++)try{d[e].apply(null,c)}catch(g){}}}};g.enableEvents(d),d.setContent=function(a){$(b.element).find(".editor").html(a)},b=$.extend(e,b),c(b)};a.Editor=b}(this);